import{r as n,j as e,A}from"./index-KsYDKmBl.js";import{g as k,B as S,d as D,a as E}from"./index-AWnBbuRW.js";import{S as F}from"./index-zyN6SVxy.js";import{f as b}from"./utils-QMY9RplF.js";const O="index-module_box_0687e",U={box:O},H="/b-tools/content/upload.png",_=[2,3,4,5,6],T=_.map(l=>({value:l,label:` ${l} 张`}));function J(){const{splitImage:l,setSplitImage:z}=k(),[o,u]=n.useState(""),[m,x]=n.useState({width:0,height:0,size:"0kb"}),[r,f]=n.useState([]),j=n.useRef(null),[d,R]=n.useState(3),y=n.useRef(null),N=n.useRef(null);n.useEffect(()=>{l&&(u(l),w(l))},[]);const B=s=>{const t=s.target.files;if(!t)return;const i=t[0],a=window.URL.createObjectURL(i);x(c=>({...c,size:b(i.size||0)})),u(a),z(a),w(a),s.target.value=""};function w(s){const t=new Image;t.onload=()=>{const{width:i,height:a}=t;x(c=>({...c,width:i,height:a}))},t.src=s}const L=async()=>{if(r.length){for(let s=0;s<r.length;s++)await D(r[s].url,"详情.png");A.success("下载完成")}},C=async()=>{const s=new Image;s.src=o,f([]);const t=[];s.onload=()=>{var I;const i=N.current;if(!i)return;const a=i.getContext("2d"),{width:c,height:P}=s;let h=Number((I=j.current)==null?void 0:I.value);(typeof h!="number"||isNaN(h))&&(h=0);const p=(P-h)/d;for(let g=0;g<d;g++){a==null||a.clearRect(0,0,i.width,i.height),i.width=c,i.height=p,a==null||a.drawImage(s,0,-g*p);const v=i.toDataURL();t.push({url:v,width:c,height:p,size:b(E(v))}),t.length===d&&f(t)}}};return e.jsx(e.Fragment,{children:e.jsxs("main",{className:U.box,children:[e.jsx("h2",{children:"Slice Picture"}),e.jsxs("section",{className:"content",children:[e.jsx("section",{className:"left",children:e.jsxs("div",{className:"upload",children:[e.jsx("input",{type:"file",className:"file",onChange:B,accept:"image/*"}),e.jsx("img",{src:H,alt:""}),e.jsx("div",{className:"text",children:"将图片拖到此处，或点击上传"}),o&&e.jsx("img",{src:o,className:"image",ref:y})]})}),e.jsxs("section",{className:"right",children:[e.jsxs("div",{className:"handleBtn",children:[e.jsx(S,{className:"previewBtn",disabled:!o,onClick:C,children:"preview"}),e.jsx(S,{disabled:!o,primary:!0,onClick:L,children:"Download"})]}),e.jsxs("div",{className:"fileDetail",children:[e.jsxs("span",{className:"fileNum",children:["图片尺寸：",m.width," x ",m.height]}),e.jsxs("span",{className:"fileNum",children:["图片大小：",m.size]})]}),e.jsx(F,{value:d,onSelect:R,OPTIONS:T,label:"分割张数："}),e.jsxs("div",{className:"sizeInput",children:[e.jsx("span",{className:"sizeInputIcon"}),e.jsx("label",{htmlFor:"splitInput",children:"去除尾部："}),e.jsx("input",{ref:j,id:"splitInput",type:"text",placeholder:"高度"})]})]})]}),e.jsx("canvas",{ref:N,style:{display:"none"}}),e.jsxs("section",{className:"preview",children:[e.jsx("h1",{children:"预览"}),e.jsx("div",{className:"previewList",children:r.map((s,t)=>e.jsxs("div",{className:"item",children:[e.jsx("div",{className:"index",children:t+1}),e.jsx("img",{src:s.url}),e.jsxs("div",{className:"imageInfo",children:[e.jsxs("p",{children:["尺寸：",s.width," x ",s.height]}),e.jsxs("p",{children:["大小：",s.size]}),e.jsx("p",{})]})]}))})]})]})})}export{J as default};
